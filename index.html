<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algebra Renova - Rede Social Revolucionária</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #11111a;
            --bg-tertiary: #1a1a2e;
            --bg-quaternary: #252540;
            --bg-hover: #2d2d4a;
            --accent-primary: #9d00ff;
            --accent-secondary: #00d9ff;
            --accent-tertiary: #ff00cc;
            --text-primary: #f0f0ff;
            --text-secondary: #b0b0d0;
            --text-muted: #8888aa;
            --border-color: #2a2a3e;
            --success: #00ff88;
            --warning: #ffcc00;
            --error: #ff5555;
            --online: #00ff88;
            --idle: #ffaa00;
            --dnd: #ff5555;
            --offline: #666699;
            
            /* Cores dos cargos */
            --cargo-1: #ff5555;
            --cargo-2: #ffaa00;
            --cargo-3: #ffff55;
            --cargo-4: #55ff55;
            --cargo-5: #55ffff;
            --cargo-6: #5555ff;
            --cargo-7: #aa55ff;
            --cargo-8: #ff55ff;
            --cargo-9: #9d00ff;
            --cargo-10: #00d9ff;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            height: 100vh;
            overflow: hidden;
        }

        .app-container {
            display: flex;
            height: 100vh;
        }

        /* Modal de Login */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-container {
            background: var(--bg-secondary);
            width: 420px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            border: 1px solid var(--accent-primary);
            position: relative;
        }

        .login-header {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .login-header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        }

        .renova-logo {
            font-family: 'Times New Roman', serif;
            font-size: 36px;
            font-weight: bold;
            background: linear-gradient(135deg, #ffffff, #e0e0ff);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 10px rgba(157, 0, 255, 0.5);
            margin-bottom: 10px;
            position: relative;
        }

        .login-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            font-style: italic;
            position: relative;
        }

        .login-form {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 14px 18px;
            background-color: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 16px;
            transition: all 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 2px rgba(157, 0, 255, 0.2);
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 10px;
            position: relative;
            overflow: hidden;
        }

        .login-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: 0.5s;
        }

        .login-btn:hover::before {
            left: 100%;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(157, 0, 255, 0.4);
        }

        .login-footer {
            text-align: center;
            margin-top: 20px;
            color: var(--text-muted);
            font-size: 14px;
        }

        .login-footer a {
            color: var(--accent-secondary);
            text-decoration: none;
            font-weight: 500;
        }

        .login-footer a:hover {
            text-decoration: underline;
        }

        .error-message {
            color: var(--error);
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        /* Sidebar de Servidores */
        .servers-sidebar {
            width: 80px;
            background-color: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
            border-right: 1px solid var(--border-color);
            overflow-y: auto;
        }

        .server-icon {
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background-color: var(--bg-tertiary);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
            position: relative;
            color: var(--text-secondary);
            font-size: 18px;
        }

        .server-icon:hover {
            border-radius: 35%;
            background-color: var(--bg-quaternary);
            color: var(--text-primary);
        }

        .server-icon.active {
            border-radius: 35%;
            border-color: var(--accent-primary);
            background-color: var(--bg-quaternary);
            color: var(--text-primary);
        }

        .server-icon.main {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            font-weight: bold;
            font-size: 20px;
        }

        .server-separator {
            width: 40px;
            height: 2px;
            background-color: var(--border-color);
            margin: 15px 0;
        }

        .server-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        /* Sidebar de Canais */
        .channels-sidebar {
            width: 280px;
            background-color: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            border-right: 1px solid var(--border-color);
        }

        .server-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--bg-tertiary);
        }

        .server-name {
            font-size: 20px;
            font-weight: bold;
            color: var(--accent-secondary);
        }

        .server-dropdown {
            cursor: pointer;
            color: var(--text-muted);
            padding: 5px;
            border-radius: 4px;
        }

        .server-dropdown:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        .channel-category {
            padding: 18px 20px 8px;
            color: var(--text-muted);
            font-size: 12px;
            font-weight: bold;
            letter-spacing: 1px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            text-transform: uppercase;
        }

        .channel-category:hover {
            color: var(--text-secondary);
        }

        .channel-add {
            cursor: pointer;
            opacity: 0.7;
        }

        .channel-add:hover {
            opacity: 1;
        }

        .channel {
            padding: 10px 20px;
            color: var(--text-secondary);
            cursor: pointer;
            display: flex;
            align-items: center;
            transition: all 0.2s;
            margin: 2px 10px;
            border-radius: 4px;
        }

        .channel:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        .channel.active {
            background-color: var(--bg-quaternary);
            color: var(--text-primary);
        }

        .channel i {
            margin-right: 10px;
            font-size: 16px;
            width: 20px;
            text-align: center;
        }

        .channel-lock {
            margin-left: auto;
            color: var(--text-muted);
            font-size: 12px;
        }

        .user-panel {
            margin-top: auto;
            background-color: var(--bg-tertiary);
            padding: 15px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-top: 1px solid var(--border-color);
        }

        .user-info {
            display: flex;
            align-items: center;
            flex: 1;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            position: relative;
            flex-shrink: 0;
        }

        .user-status {
            position: absolute;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: 3px solid var(--bg-tertiary);
            bottom: 0;
            right: 0;
        }

        .user-details {
            flex: 1;
            min-width: 0;
        }

        .user-name {
            font-weight: bold;
            font-size: 14px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .user-tag {
            display: flex;
            align-items: center;
            margin-top: 2px;
        }

        .user-cargo {
            font-size: 11px;
            padding: 2px 6px;
            border-radius: 10px;
            font-weight: bold;
            margin-right: 6px;
        }

        .user-status-text {
            font-size: 12px;
            color: var(--text-muted);
        }

        .user-controls {
            display: flex;
            gap: 8px;
        }

        .user-control {
            cursor: pointer;
            padding: 6px;
            border-radius: 4px;
            color: var(--text-muted);
            transition: all 0.2s;
        }

        .user-control:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Área Principal de Chat */
        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: var(--bg-primary);
        }

        .chat-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--bg-secondary);
        }

        .channel-info {
            display: flex;
            flex-direction: column;
        }

        .channel-title {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
        }

        .channel-title i {
            margin-right: 10px;
            color: var(--text-muted);
            font-size: 20px;
        }

        .channel-title h2 {
            font-size: 22px;
            font-weight: bold;
            color: var(--text-primary);
        }

        .channel-description {
            color: var(--text-muted);
            font-size: 14px;
            display: flex;
            align-items: center;
        }

        .channel-topic {
            color: var(--text-secondary);
            font-size: 14px;
        }

        .chat-header-actions {
            display: flex;
            gap: 15px;
        }

        .chat-action {
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            color: var(--text-muted);
            transition: all 0.2s;
            position: relative;
        }

        .chat-action:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        .chat-action-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background-color: var(--error);
            color: white;
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            min-width: 18px;
            text-align: center;
        }

        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 20px;
            background: linear-gradient(to bottom, var(--bg-primary), rgba(26, 26, 46, 0.5));
        }

        .message {
            display: flex;
            gap: 15px;
            padding: 5px 0;
            position: relative;
        }

        .message:hover {
            background-color: rgba(42, 42, 62, 0.1);
        }

        .message-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
            position: relative;
        }

        .message-cargo {
            position: absolute;
            bottom: -5px;
            right: -5px;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 10px;
            font-weight: bold;
            border: 2px solid var(--bg-primary);
        }

        .message-content {
            max-width: 70%;
        }

        .message-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .message-sender {
            font-weight: bold;
            color: var(--text-primary);
            font-size: 16px;
        }

        .message-time {
            font-size: 12px;
            color: var(--text-muted);
        }

        .message-text {
            background-color: var(--bg-tertiary);
            padding: 14px 18px;
            border-radius: 0 18px 18px 18px;
            color: var(--text-secondary);
            line-height: 1.5;
            position: relative;
            word-break: break-word;
        }

        .message-text::before {
            content: '';
            position: absolute;
            top: 0;
            left: -8px;
            width: 8px;
            height: 16px;
            background-color: var(--bg-tertiary);
            clip-path: polygon(100% 0, 0 50%, 100% 100%);
        }

        .message.own {
            flex-direction: row-reverse;
        }

        .message.own .message-content {
            align-items: flex-end;
        }

        .message.own .message-text {
            background-color: var(--accent-primary);
            color: white;
            border-radius: 18px 0 18px 18px;
        }

        .message.own .message-text::before {
            left: auto;
            right: -8px;
            clip-path: polygon(0 0, 100% 50%, 0 100%);
            background-color: var(--accent-primary);
        }

        .message.own .message-header {
            flex-direction: row-reverse;
        }

        .message-actions {
            display: flex;
            gap: 10px;
            margin-top: 8px;
            opacity: 0;
            transition: opacity 0.2s;
        }

        .message:hover .message-actions {
            opacity: 1;
        }

        .message-action {
            cursor: pointer;
            color: var(--text-muted);
            font-size: 14px;
            transition: color 0.2s;
        }

        .message-action:hover {
            color: var(--text-primary);
        }

        .chat-input-area {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            background-color: var(--bg-secondary);
        }

        .chat-input-container {
            background-color: var(--bg-tertiary);
            border-radius: 12px;
            padding: 12px 18px;
            display: flex;
            align-items: center;
            border: 1px solid transparent;
            transition: border-color 0.3s;
        }

        .chat-input-container:focus-within {
            border-color: var(--accent-primary);
        }

        .chat-input-add {
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            color: var(--text-muted);
            margin-right: 10px;
        }

        .chat-input-add:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        .chat-input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--text-primary);
            font-size: 16px;
            outline: none;
            padding: 8px 12px;
        }

        .chat-input::placeholder {
            color: var(--text-muted);
        }

        .chat-input-actions {
            display: flex;
            gap: 10px;
        }

        .chat-input-action {
            cursor: pointer;
            padding: 10px;
            border-radius: 6px;
            color: var(--text-muted);
            transition: all 0.2s;
        }

        .chat-input-action:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }

        /* Painel de Membros */
        .members-sidebar {
            width: 260px;
            background-color: var(--bg-secondary);
            display: flex;
            flex-direction: column;
            border-left: 1px solid var(--border-color);
        }

        .members-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            font-size: 18px;
            font-weight: bold;
            color: var(--text-primary);
            background-color: var(--bg-tertiary);
        }

        .members-search {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
        }

        .search-input {
            width: 100%;
            padding: 10px 15px;
            background-color: var(--bg-quaternary);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            color: var(--text-primary);
            font-size: 14px;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--accent-primary);
        }

        .members-list {
            flex: 1;
            overflow-y: auto;
            padding: 10px 0;
        }

        .members-category {
            padding: 15px 20px 5px;
            color: var(--text-muted);
            font-size: 12px;
            font-weight: bold;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .member {
            display: flex;
            align-items: center;
            padding: 10px 20px;
            border-radius: 5px;
            margin: 2px 10px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .member:hover {
            background-color: var(--bg-hover);
        }

        .member-avatar {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            margin-right: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
            position: relative;
            flex-shrink: 0;
        }

        .member-status {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            border: 2px solid var(--bg-secondary);
            bottom: 0;
            right: 0;
        }

        .member-details {
            flex: 1;
            min-width: 0;
        }

        .member-name {
            font-size: 14px;
            color: var(--text-primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .member-activity {
            font-size: 12px;
            color: var(--text-muted);
            margin-top: 2px;
        }

        .member-cargo {
            font-size: 10px;
            padding: 3px 8px;
            border-radius: 12px;
            font-weight: bold;
            margin-left: auto;
            flex-shrink: 0;
        }

        /* Modais e Menus */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2000;
        }

        .modal-content {
            background-color: var(--bg-secondary);
            border-radius: 12px;
            width: 500px;
            max-width: 90%;
            max-height: 90%;
            overflow: hidden;
            border: 1px solid var(--accent-primary);
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.7);
        }

        .modal-header {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            padding: 25px;
            text-align: center;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin-bottom: 5px;
        }

        .modal-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
        }

        .modal-body {
            padding: 25px;
            overflow-y: auto;
            max-height: 60vh;
        }

        .modal-footer {
            padding: 20px 25px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .btn {
            padding: 12px 24px;
            border-radius: 8px;
            border: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(157, 0, 255, 0.4);
        }

        .btn-secondary {
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
        }

        .btn-secondary:hover {
            background-color: var(--bg-hover);
        }

        .close-modal {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 28px;
            cursor: pointer;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.2s;
        }

        .close-modal:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        /* Cargos */
        .cargo-1 { background-color: var(--cargo-1); color: white; }
        .cargo-2 { background-color: var(--cargo-2); color: black; }
        .cargo-3 { background-color: var(--cargo-3); color: black; }
        .cargo-4 { background-color: var(--cargo-4); color: black; }
        .cargo-5 { background-color: var(--cargo-5); color: black; }
        .cargo-6 { background-color: var(--cargo-6); color: white; }
        .cargo-7 { background-color: var(--cargo-7); color: white; }
        .cargo-8 { background-color: var(--cargo-8); color: white; }
        .cargo-9 { background-color: var(--cargo-9); color: white; }
        .cargo-10 { background-color: var(--cargo-10); color: black; }

        /* Status */
        .status-online { background-color: var(--online); }
        .status-idle { background-color: var(--idle); }
        .status-dnd { background-color: var(--dnd); }
        .status-offline { background-color: var(--offline); }

        /* Utilitários */
        .hidden {
            display: none !important;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { opacity: 0.8; }
            50% { opacity: 1; }
            100% { opacity: 0.8; }
        }

        .scrollbar {
            scrollbar-width: thin;
            scrollbar-color: var(--border-color) var(--bg-secondary);
        }

        .scrollbar::-webkit-scrollbar {
            width: 8px;
        }

        .scrollbar::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        .scrollbar::-webkit-scrollbar-thumb {
            background-color: var(--border-color);
            border-radius: 4px;
        }

        /* Responsividade */
        @media (max-width: 1200px) {
            .members-sidebar {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .channels-sidebar {
                position: absolute;
                left: 80px;
                top: 0;
                bottom: 0;
                z-index: 100;
                box-shadow: 5px 0 15px rgba(0, 0, 0, 0.5);
                transform: translateX(-100%);
                transition: transform 0.3s;
            }
            
            .channels-sidebar.active {
                transform: translateX(0);
            }
            
            .servers-sidebar {
                width: 70px;
            }
            
            .server-icon {
                width: 48px;
                height: 48px;
            }
            
            .menu-toggle {
                display: block !important;
            }
        }

        .menu-toggle {
            display: none;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            color: var(--text-muted);
        }

        .menu-toggle:hover {
            background-color: var(--bg-hover);
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <!-- Modal de Login -->
    <div class="modal-overlay" id="loginModal">
        <div class="login-container">
            <div class="login-header">
                <div class="renova-logo">Algebra Renova</div>
                <div class="login-subtitle">Revolution. Algebra et Perseverantia.</div>
            </div>
            <div class="login-form">
                <div class="form-group">
                    <label class="form-label" for="username">Nome de Usuário</label>
                    <input type="text" id="username" class="form-input" placeholder="ex: LohanCunha" autocomplete="username">
                    <div class="error-message" id="usernameError">Por favor, insira um nome de usuário</div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="password">Senha</label>
                    <input type="password" id="password" class="form-input" placeholder="••••••••••" autocomplete="current-password">
                    <div class="error-message" id="passwordError">Por favor, insira uma senha</div>
                </div>
                <button class="login-btn" id="loginButton" onclick="login()">Entrar na Revolução</button>
                <div class="login-footer">
                    Não tem uma conta? <a href="#" onclick="showRegister()">Registre-se</a>
                    <br><br>
                    <small>Dica: Use a senha "Abstrato Renova" para acessar o cargo máximo</small>
                </div>
            </div>
        </div>
    </div>

    <!-- Interface Principal -->
    <div class="app-container hidden" id="appContainer">
        <!-- Sidebar de Servidores -->
        <div class="servers-sidebar scrollbar">
            <div class="server-icon main active" data-server="main">
                AR
            </div>
            <div class="server-icon" data-server="pesquisa">
                <i class="fas fa-atom"></i>
            </div>
            <div class="server-icon" data-server="teoria">
                <i class="fas fa-infinity"></i>
                <div class="server-badge">3</div>
            </div>
            <div class="server-icon" data-server="desenvolvimento">
                <i class="fas fa-cogs"></i>
            </div>
            <div class="server-icon" data-server="colaboracao">
                <i class="fas fa-users"></i>
            </div>
            <div class="server-separator"></div>
            <div class="server-icon" onclick="showAddFriendModal()" title="Adicionar Amigos">
                <i class="fas fa-user-plus"></i>
            </div>
            <div class="server-icon" onclick="showCreateGroupModal()" title="Criar Grupo">
                <i class="fas fa-plus"></i>
            </div>
            <div class="server-icon" onclick="showSettingsModal()" title="Configurações">
                <i class="fas fa-cog"></i>
            </div>
        </div>

        <!-- Sidebar de Canais -->
        <div class="channels-sidebar scrollbar">
            <div class="server-header">
                <div class="server-name">Algebra Renova</div>
                <div class="server-dropdown">
                    <i class="fas fa-chevron-down"></i>
                </div>
            </div>

            <div class="channel-category">
                <span>TEXTUAIS</span>
                <div class="channel-add">
                    <i class="fas fa-plus"></i>
                </div>
            </div>
            <div class="channel active" data-channel="geral">
                <i class="fas fa-hashtag"></i>
                <span>geral</span>
                <i class="fas fa-lock channel-lock hidden"></i>
            </div>
            <div class="channel" data-channel="introducoes">
                <i class="fas fa-hashtag"></i>
                <span>introduções</span>
                <i class="fas fa-lock channel-lock hidden"></i>
            </div>
            <div class="channel" data-channel="offtopic">
                <i class="fas fa-hashtag"></i>
                <span>off-topic</span>
                <i class="fas fa-lock channel-lock hidden"></i>
            </div>
            <div class="channel" data-channel="anuncios">
                <i class="fas fa-bullhorn"></i>
                <span>anúncios</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>

            <div class="channel-category">
                <span>GRUPOS DE PESQUISA</span>
                <div class="channel-add">
                    <i class="fas fa-plus"></i>
                </div>
            </div>
            <div class="channel" data-channel="transfunctoracao">
                <i class="fas fa-flask"></i>
                <span>transfunctoração</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>
            <div class="channel" data-channel="estruturas-impossiveis">
                <i class="fas fa-project-diagram"></i>
                <span>estruturas-impossíveis</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>
            <div class="channel" data-channel="anti-identidades">
                <i class="fas fa-shapes"></i>
                <span>anti-identidades</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>
            <div class="channel" data-channel="geometria-nao-convencional">
                <i class="fas fa-draw-polygon"></i>
                <span>geometria-não-convencional</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>

            <div class="channel-category">
                <span>VOZ</span>
                <div class="channel-add">
                    <i class="fas fa-plus"></i>
                </div>
            </div>
            <div class="channel" data-channel="voz-geral">
                <i class="fas fa-volume-up"></i>
                <span>Sala de Voz Geral</span>
                <i class="fas fa-lock channel-lock hidden"></i>
            </div>
            <div class="channel" data-channel="colaboracao-voz">
                <i class="fas fa-headset"></i>
                <span>Colaboração</span>
                <i class="fas fa-lock channel-lock"></i>
            </div>

            <div class="user-panel">
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">
                        <span id="userAvatarText">U</span>
                        <div class="user-status" id="userStatus"></div>
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Usuário</div>
                        <div class="user-tag">
                            <div class="user-cargo" id="userCargoTag">Cargo 1</div>
                            <div class="user-status-text" id="userStatusText">Online</div>
                        </div>
                    </div>
                </div>
                <div class="user-controls">
                    <div class="user-control" onclick="toggleMute()" title="Microfone">
                        <i class="fas fa-microphone"></i>
                    </div>
                    <div class="user-control" onclick="showSettingsModal()" title="Configurações">
                        <i class="fas fa-cog"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Área Principal de Chat -->
        <div class="chat-area">
            <div class="chat-header">
                <div class="channel-info">
                    <div class="channel-title">
                        <i class="fas fa-hashtag"></i>
                        <h2 id="currentChannel">geral</h2>
                    </div>
                    <div class="channel-description">
                        <i class="fas fa-quote-left"></i>
                        <span id="channelDescription" class="channel-topic">O canal principal para discussões revolucionárias. Seja bem-vindo à rebelião matemática.</span>
                    </div>
                </div>
                <div class="chat-header-actions">
                    <div class="chat-action" onclick="toggleMembers()" title="Membros">
                        <i class="fas fa-user-friends"></i>
                    </div>
                    <div class="chat-action" onclick="showPinnedMessages()" title="Mensagens Fixadas">
                        <i class="fas fa-pin"></i>
                    </div>
                    <div class="chat-action" onclick="toggleNotifications()" title="Notificações">
                        <i class="fas fa-bell"></i>
                        <div class="chat-action-badge">3</div>
                    </div>
                    <div class="chat-action menu-toggle" onclick="toggleChannels()" title="Menu">
                        <i class="fas fa-bars"></i>
                    </div>
                </div>
            </div>

            <div class="chat-messages scrollbar" id="chatMessages">
                <!-- Mensagens serão carregadas via JavaScript -->
            </div>

            <div class="chat-input-area">
                <div class="chat-input-container">
                    <div class="chat-input-add" onclick="showAttachmentMenu()">
                        <i class="fas fa-plus"></i>
                    </div>
                    <input type="text" class="chat-input" id="messageInput" placeholder="Mensagem para #geral" onkeypress="sendMessageOnEnter(event)">
                    <div class="chat-input-actions">
                        <div class="chat-input-action" onclick="showEmojiPicker()" title="Emoji">
                            <i class="fas fa-smile"></i>
                        </div>
                        <div class="chat-input-action" onclick="uploadFile()" title="Enviar Arquivo">
                            <i class="fas fa-image"></i>
                        </div>
                        <div class="chat-input-action" onclick="sendMessage()" title="Enviar Mensagem">
                            <i class="fas fa-paper-plane"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Painel de Membros -->
        <div class="members-sidebar scrollbar" id="membersSidebar">
            <div class="members-header">
                Membros - <span id="onlineCount">5</span>
            </div>
            <div class="members-search">
                <input type="text" class="search-input" placeholder="Buscar membros..." id="memberSearch">
            </div>
            <div class="members-list" id="membersList">
                <!-- Membros serão carregados via JavaScript -->
            </div>
        </div>
    </div>

    <!-- Modal Adicionar Amigos -->
    <div class="modal hidden" id="addFriendModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Adicionar Amigos</div>
                <div class="modal-subtitle">Conecte-se com outros revolucionários matemáticos</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label" for="friendUsername">Nome de Usuário</label>
                    <input type="text" id="friendUsernameInput" class="form-input" placeholder="ex: GeoTopoExpert">
                    <div class="error-message" id="friendUsernameError">Por favor, insira um nome de usuário válido</div>
                </div>
                <div class="form-group">
                    <label class="form-label" for="friendMessage">Mensagem (opcional)</label>
                    <textarea id="friendMessage" class="form-input" rows="3" placeholder="Olá, gostaria de me conectar com você para discutir transfunctoração..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('addFriendModal')">Cancelar</button>
                <button class="btn btn-primary" onclick="sendFriendRequest()">Enviar Solicitação</button>
            </div>
        </div>
        <button class="close-modal" onclick="closeModal('addFriendModal')">×</button>
    </div>

    <!-- Modal Configurações -->
    <div class="modal hidden" id="settingsModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">Configurações</div>
                <div class="modal-subtitle">Personalize sua experiência no Algebra Renova</div>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Status</label>
                    <div style="display: flex; gap: 10px; margin-top: 10px;">
                        <button class="btn btn-secondary" onclick="setStatus('online')" style="flex: 1;">
                            <i class="fas fa-circle" style="color: var(--online); margin-right: 5px;"></i>
                            Online
                        </button>
                        <button class="btn btn-secondary" onclick="setStatus('idle')" style="flex: 1;">
                            <i class="fas fa-moon" style="color: var(--idle); margin-right: 5px;"></i>
                            Ausente
                        </button>
                        <button class="btn btn-secondary" onclick="setStatus('dnd')" style="flex: 1;">
                            <i class="fas fa-minus-circle" style="color: var(--dnd); margin-right: 5px;"></i>
                            Não Perturbe
                        </button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Tema</label>
                    <select class="form-input" id="themeSelect" onchange="changeTheme()">
                        <option value="dark">Escuro (Padrão)</option>
                        <option value="darker">Mais Escuro</option>
                        <option value="purple">Roxo Profundo</option>
                        <option value="blue">Azul Matemático</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notificações</label>
                    <div style="margin-top: 10px;">
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" id="notifMessages" checked style="margin-right: 10px;">
                            Notificar sobre novas mensagens
                        </label>
                        <label style="display: flex; align-items: center; margin-bottom: 10px;">
                            <input type="checkbox" id="notifMentions" checked style="margin-right: 10px;">
                            Notificar sobre menções
                        </label>
                        <label style="display: flex; align-items: center;">
                            <input type="checkbox" id="notifFriends" checked style="margin-right: 10px;">
                            Notificar sobre atividades de amigos
                        </label>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-primary" onclick="closeModal('settingsModal')">Salvar</button>
            </div>
        </div>
        <button class="close-modal" onclick="closeModal('settingsModal')">×</button>
    </div>

    <script>
        // Sistema Completo do Algebra Renova

        // Definição dos Cargos (1-10)
        const cargos = [
            { id: 1, nome: "Novato", cor: "cargo-1", descricao: "Iniciante na revolução", privilegios: [] },
            { id: 2, nome: "Aprendiz", cor: "cargo-2", descricao: "Começando a entender", privilegios: ["chat_basico"] },
            { id: 3, nome: "Estudante", cor: "cargo-3", descricao: "Estudante dedicado", privilegios: ["chat_basico", "enviar_arquivos"] },
            { id: 4, nome: "Pesquisador", cor: "cargo-4", descricao: "Pesquisador ativo", privilegios: ["chat_basico", "enviar_arquivos", "criar_canais"] },
            { id: 5, nome: "Teórico", cor: "cargo-5", descricao: "Desenvolve teorias", privilegios: ["chat_basico", "enviar_arquivos", "criar_canais", "moderar_chat"] },
            { id: 6, nome: "Inovador", cor: "cargo-6", descricao: "Cria novas abordagens", privilegios: ["todos_privilegios", "gerenciar_grupos"] },
            { id: 7, nome: "Revolucionário", cor: "cargo-7", descricao: "Muda paradigmas", privilegios: ["todos_privilegios", "gerenciar_grupos", "convidar_pessoas"] },
            { id: 8, nome: "Visionário", cor: "cargo-8", descricao: "Vê além do possível", privilegios: ["todos_privilegios", "gerenciar_grupos", "convidar_pessoas", "gerenciar_cargos_baixos"] },
            { id: 9, nome: "Arquiteto", cor: "cargo-9", descricao: "Constrói fundamentos", privilegios: ["todos_privilegios", "gerenciar_tudo", "acesso_total"] },
            { id: 10, nome: "Fundador", cor: "cargo-10", descricao: "Criador da revolução", privilegios: ["administrador_total", "acesso_sistema", "controle_completo"] }
        ];

        // Definição dos Membros
        const membros = [
            { id: 1, nome: "Lohan Cunha", avatar: "LC", cargo: 10, status: "online", atividade: "Criando novas estruturas" },
            { id: 2, nome: "Maria Curie", avatar: "MC", cargo: 9, status: "online", atividade: "Pesquisando transfunctoração" },
            { id: 3, nome: "Alan Turing", avatar: "AT", cargo: 8, status: "idle", atividade: "Desenvolvendo lógica" },
            { id: 4, nome: "Évariste Galois", avatar: "EG", cargo: 8, status: "online", atividade: "Explorando grupos" },
            { id: 5, nome: "Katherine Johnson", avatar: "KJ", cargo: 7, status: "online", atividade: "Calculando infinitos" },
            { id: 6, nome: "Isaac Newton", avatar: "IN", cargo: 6, status: "dnd", atividade: "Não Perturbe" },
            { id: 7, nome: "Leonhard Euler", avatar: "LE", cargo: 6, status: "offline", atividade: "Última vez: 2h atrás" },
            { id: 8, nome: "Galileo Galilei", avatar: "GG", cargo: 5, status: "offline", atividade: "Última vez: 1d atrás" },
            { id: 9, nome: "Ada Lovelace", avatar: "AL", cargo: 4, status: "online", atividade: "Programando algoritmos" },
            { id: 10, nome: "Carl Gauss", avatar: "CG", cargo: 3, status: "online", atividade: "Analisando padrões" }
        ];

        // Definição dos Canais
        const canais = {
            geral: {
                nome: "geral",
                titulo: "geral",
                descricao: "O canal principal para discussões revolucionárias. Seja bem-vindo à rebelião matemática.",
                bloqueado: false,
                tipo: "texto",
                mensagens: []
            },
            introducoes: {
                nome: "introducoes",
                titulo: "introduções",
                descricao: "Apresente-se para a comunidade. Conte sobre seus interesses matemáticos.",
                bloqueado: false,
                tipo: "texto",
                mensagens: []
            },
            offtopic: {
                nome: "offtopic",
                titulo: "off-topic",
                descricao: "Discussões não relacionadas à matemática. Descontraia-se aqui.",
                bloqueado: false,
                tipo: "texto",
                mensagens: []
            },
            anuncios: {
                nome: "anuncios",
                titulo: "anúncios",
                descricao: "Anúncios importantes da administração do Algebra Renova.",
                bloqueado: true,
                tipo: "texto",
                mensagens: []
            },
            transfunctoracao: {
                nome: "transfunctoracao",
                titulo: "transfunctoração",
                descricao: "Discussões sobre transfunctoração: a capacidade de uma estrutura emergir em outro domínio.",
                bloqueado: true,
                tipo: "pesquisa",
                mensagens: []
            },
            "estruturas-impossiveis": {
                nome: "estruturas-impossiveis",
                titulo: "estruturas-impossíveis",
                descricao: "Pesquisa sobre estruturas que desafiam a lógica convencional.",
                bloqueado: true,
                tipo: "pesquisa",
                mensagens: []
            },
            "anti-identidades": {
                nome: "anti-identidades",
                titulo: "anti-identidades",
                descricao: "Estudo das anti-identidades e sua aplicação na reconstrução algébrica.",
                bloqueado: true,
                tipo: "pesquisa",
                mensagens: []
            },
            "geometria-nao-convencional": {
                nome: "geometria-nao-convencional",
                titulo: "geometria-não-convencional",
                descricao: "Exploração de geometrias além das euclidianas.",
                bloqueado: true,
                tipo: "pesquisa",
                mensagens: []
            }
        };

        // Estado da aplicação
        let currentUser = null;
        let currentChannel = "geral";
        let messages = [];
        let userCargo = 1;
        let userStatus = "online";
        let isMuted = false;
        let membersVisible = true;

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            // Carregar mensagens iniciais
            loadInitialMessages();
            
            // Configurar eventos
            setupEventListeners();
            
            // Carregar lista de membros
            loadMembers();
            
            // Verificar se há usuário salvo
            const savedUser = localStorage.getItem('algebraRenovaUser');
            if (savedUser) {
                try {
                    const userData = JSON.parse(savedUser);
                    document.getElementById('username').value = userData.username || '';
                } catch(e) {
                    localStorage.removeItem('algebraRenovaUser');
                }
            }
        });

        // Configurar eventos
        function setupEventListeners() {
            // Enter no login
            document.getElementById('password').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') login();
            });
            
            // Busca de membros
            document.getElementById('memberSearch').addEventListener('input', function(e) {
                filterMembers(e.target.value);
            });
            
            // Alternar canais
            document.querySelectorAll('.channel').forEach(channel => {
                channel.addEventListener('click', function() {
                    const channelName = this.getAttribute('data-channel');
                    changeChannel(channelName);
                });
            });
            
            // Alternar servidores
            document.querySelectorAll('.server-icon').forEach(server => {
                server.addEventListener('click', function() {
                    if (this.classList.contains('main')) return;
                    
                    const serverName = this.getAttribute('data-server');
                    changeServer(serverName);
                });
            });
        }

        // Função de login
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            let valid = true;
            
            // Validar campos
            if (!username) {
                document.getElementById('usernameError').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('usernameError').style.display = 'none';
            }
            
            if (!password) {
                document.getElementById('passwordError').style.display = 'block';
                valid = false;
            } else {
                document.getElementById('passwordError').style.display = 'none';
            }
            
            if (!valid) return;
            
            // Determinar cargo baseado na senha
            let cargo = 1;
            if (password.toLowerCase() === "abstrato renova") {
                cargo = 10; // Cargo máximo
            } else if (password.length > 8) {
                cargo = Math.min(3 + Math.floor(password.length / 3), 9);
            }
            
            // Criar usuário
            currentUser = {
                id: Date.now(),
                nome: username,
                avatar: getInitials(username),
                cargo: cargo,
                status: "online"
            };
            
            userCargo = cargo;
            userStatus = "online";
            
            // Salvar no localStorage
            localStorage.setItem('algebraRenovaUser', JSON.stringify({
                username: username,
                cargo: cargo
            }));
            
            // Atualizar interface
            updateUserInterface();
            
            // Esconder login e mostrar app
            document.getElementById('loginModal').style.display = 'none';
            document.getElementById('appContainer').classList.remove('hidden');
            
            // Adicionar mensagem de boas-vindas
            addSystemMessage(`Bem-vindo(a) à revolução matemática, ${username}! Seu cargo: ${cargos[cargo-1].nome}.`);
            
            // Atualizar lista de membros com novo usuário
            loadMembers();
        }

        // Atualizar interface do usuário
        function updateUserInterface() {
            if (!currentUser) return;
            
            // Atualizar avatar e nome
            document.getElementById('userAvatarText').textContent = currentUser.avatar;
            document.getElementById('userName').textContent = currentUser.nome;
            
            // Atualizar cargo
            const cargoInfo = cargos[userCargo-1];
            const cargoElement = document.getElementById('userCargoTag');
            cargoElement.textContent = cargoInfo.nome;
            cargoElement.className = `user-cargo ${cargoInfo.cor}`;
            
            // Atualizar status
            setStatus(userStatus);
            
            // Verificar privilégios
            updatePrivileges();
        }

        // Atualizar privilégios baseados no cargo
        function updatePrivileges() {
            const cargoInfo = cargos[userCargo-1];
            const privilegios = cargoInfo.privilegios;
            
            // Mostrar/ocultar canais bloqueados
            document.querySelectorAll('.channel-lock').forEach(lock => {
                const channelElement = lock.parentElement;
                const channelName = channelElement.getAttribute('data-channel');
                const channel = canais[channelName];
                
                if (channel && channel.bloqueado) {
                    if (privilegios.includes('acesso_total') || userCargo >= 6) {
                        lock.classList.add('hidden');
                        channelElement.style.opacity = '1';
                    } else {
                        lock.classList.remove('hidden');
                        channelElement.style.opacity = '0.6';
                    }
                }
            });
            
            // Atualizar ações disponíveis
            const canCreateChannels = privilegios.includes('criar_canais') || userCargo >= 4;
            document.querySelectorAll('.channel-add').forEach(addBtn => {
                addBtn.style.display = canCreateChannels ? 'block' : 'none';
            });
        }

        // Mudar status do usuário
        function setStatus(status) {
            userStatus = status;
            
            // Atualizar ícone
            const statusElement = document.getElementById('userStatus');
            statusElement.className = `user-status status-${status}`;
            
            // Atualizar texto
            const statusText = document.getElementById('userStatusText');
            let statusName = "Online";
            if (status === "idle") statusName = "Ausente";
            if (status === "dnd") statusName = "Não Perturbe";
            if (status === "offline") statusName = "Offline";
            statusText.textContent = statusName;
            
            // Atualizar no chat se for mensagem própria
            const userMessages = document.querySelectorAll('.message-avatar');
            userMessages.forEach(msg => {
                if (msg.textContent === currentUser.avatar) {
                    const statusIndicator = msg.querySelector('.message-cargo-status');
                    if (statusIndicator) {
                        statusIndicator.className = `message-cargo-status status-${status}`;
                    }
                }
            });
        }

        // Alternar mute
        function toggleMute() {
            isMuted = !isMuted;
            const icon = document.querySelector('.user-control .fa-microphone');
            if (isMuted) {
                icon.classList.remove('fa-microphone');
                icon.classList.add('fa-microphone-slash');
                icon.style.color = 'var(--error)';
            } else {
                icon.classList.remove('fa-microphone-slash');
                icon.classList.add('fa-microphone');
                icon.style.color = '';
            }
        }

        // Mudar canal
        function changeChannel(channelName) {
            if (!canais[channelName]) return;
            
            // Verificar se o canal está bloqueado
            if (canais[channelName].bloqueado && userCargo < 6 && !cargos[userCargo-1].privilegios.includes('acesso_total')) {
                addSystemMessage(`Você precisa do cargo 6+ para acessar canais de pesquisa. Seu cargo: ${cargos[userCargo-1].nome}`);
                return;
            }
            
            // Atualizar canal ativo
            document.querySelectorAll('.channel').forEach(c => c.classList.remove('active'));
            document.querySelector(`.channel[data-channel="${channelName}"]`).classList.add('active');
            
            // Atualizar cabeçalho
            currentChannel = channelName;
            const channel = canais[channelName];
            document.getElementById('currentChannel').textContent = channel.titulo;
            document.getElementById('channelDescription').textContent = channel.descricao;
            
            // Carregar mensagens do canal
            loadChannelMessages(channelName);
            
            // Adicionar mensagem de entrada no canal
            if (channelName !== "geral") {
                addSystemMessage(`Você entrou no canal: ${channel.titulo}`);
            }
        }

        // Carregar mensagens do canal
        function loadChannelMessages(channelName) {
            const chatMessages = document.getElementById('chatMessages');
            chatMessages.innerHTML = '';
            
            // Mensagens padrão para cada canal
            const defaultMessages = {
                geral: [
                    { sender: "Sistema", avatar: "AR", cargo: 10, time: "Hoje às 10:00", text: "Bem-vindos ao Algebra Renova. A revolução matemática começa aqui." },
                    { sender: "Lohan Cunha", avatar: "LC", cargo: 10, time: "Hoje às 10:05", text: "A álgebra não resolve problemas antigos. Ela renasce, e com ela, renasce toda a estrutura do pensamento." },
                    { sender: "Maria Curie", avatar: "MC", cargo: 9, time: "Hoje às 10:15", text: "Alguém interessado em explorar transfunctoração aplicada à topologia quântica?" }
                ],
                introducoes: [
                    { sender: "Sistema", avatar: "AR", cargo: 10, time: "Ontem às 14:00", text: "Este é o canal para se apresentar. Conte sobre seus interesses em matemática revolucionária!" },
                    { sender: "Alan Turing", avatar: "AT", cargo: 8, time: "Ontem às 14:30", text: "Sou Alan, interessado em lógica computacional e estruturas impossíveis." }
                ],
                transfunctoracao: [
                    { sender: "Lohan Cunha", avatar: "LC", cargo: 10, time: "2 dias atrás", text: "A transfunctoração representa a capacidade de uma estrutura emergir em outro domínio com regras totalmente novas." },
                    { sender: "Maria Curie", avatar: "MC", cargo: 9, time: "1 dia atrás", text: "Estou trabalhando em um paper sobre transfunctoração em espaços não-Hausdorff. Alguém tem referências?" }
                ],
                "estruturas-impossiveis": [
                    { sender: "Alan Turing", avatar: "AT", cargo: 8, time: "3 dias atrás", text: "Estruturas impossíveis só são impossíveis dentro dos paradigmas atuais. Precisamos expandir o conceito de possibilidade." }
                ]
            };
            
            // Obter mensagens do canal
            let channelMessages = defaultMessages[channelName] || [];
            
            // Adicionar mensagens
            channelMessages.forEach(msg => {
                addMessageToChat(msg, false);
            });
            
            // Adicionar mensagem do usuário atual se houver
            if (currentUser && channelMessages.length === 0) {
                addSystemMessage(`Bem-vindo ao canal ${canais[channelName].titulo}. Este canal ainda não tem mensagens. Seja o primeiro a postar!`);
            }
        }

        // Carregar mensagens iniciais
        function loadInitialMessages() {
            loadChannelMessages("geral");
        }

        // Adicionar mensagem ao chat
        function addMessageToChat(messageData, isOwn = false) {
            const chatMessages = document.getElementById('chatMessages');
            const messageElement = document.createElement('div');
            
            messageElement.className = `message ${isOwn ? 'own' : ''}`;
            
            // Determinar cor do cargo
            const cargoInfo = cargos[messageData.cargo-1] || cargos[0];
            
            messageElement.innerHTML = `
                <div class="message-avatar">
                    ${messageData.avatar}
                    <div class="message-cargo ${cargoInfo.cor}">${messageData.cargo}</div>
                </div>
                <div class="message-content">
                    <div class="message-header">
                        <div class="message-sender">${messageData.sender}</div>
                        <div class="message-time">${messageData.time}</div>
                    </div>
                    <div class="message-text">${messageData.text}</div>
                    <div class="message-actions">
                        <span class="message-action" onclick="reactToMessage(this)">👍</span>
                        <span class="message-action" onclick="replyToMessage(this)">↩️</span>
                        <span class="message-action" onclick="moreActions(this)">⋯</span>
                    </div>
                </div>
            `;
            
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Adicionar mensagem do sistema
        function addSystemMessage(text) {
            addMessageToChat({
                sender: "Sistema Algebra Renova",
                avatar: "AR",
                cargo: 10,
                time: "Agora",
                text: text
            }, false);
        }

        // Enviar mensagem
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const messageText = messageInput.value.trim();
            
            if (!messageText || !currentUser) return;
            
            // Verificar privilégios
            if (userCargo < 2 && !cargos[userCargo-1].privilegios.includes('chat_basico')) {
                addSystemMessage("Você precisa do cargo 2+ para enviar mensagens.");
                return;
            }
            
            // Criar mensagem
            const messageData = {
                sender: currentUser.nome,
                avatar: currentUser.avatar,
                cargo: userCargo,
                time: "Agora",
                text: messageText
            };
            
            // Adicionar ao chat
            addMessageToChat(messageData, true);
            
            // Limpar campo
            messageInput.value = "";
            
            // Resposta automática para certas palavras-chave
            setTimeout(() => {
                const lowerText = messageText.toLowerCase();
                let response = null;
                
                if (lowerText.includes("transfunctoração") || lowerText.includes("transfunctoracao")) {
                    response = "A transfunctoração é a capacidade de uma estrutura emergir em outro domínio com regras totalmente novas. Representa a mutabilidade perfeita das estruturas matemáticas.";
                } else if (lowerText.includes("anti-identidade")) {
                    response = "Anti-identidades são a chave para desconstruir os pressupostos algébricos tradicionais. Elas representam a negação criativa dos fundamentos.";
                } else if (lowerText.includes("estrutura impossível") || lowerText.includes("estrutura-impossível")) {
                    response = "Estruturas impossíveis só são impossíveis dentro dos paradigmas atuais. Precisamos expandir o próprio conceito de possibilidade matemática.";
                } else if (lowerText.includes("cargo") || lowerText.includes("nível") || lowerText.includes("nivel")) {
                    response = `Seu cargo atual é: ${cargos[userCargo-1].nome}. Use a senha "Abstrato Renova" no login para alcançar o cargo máximo!`;
                } else if (lowerText.includes("álgebra renova") || lowerText.includes("algebra renova")) {
                    response = "Algebra Renova significa: A álgebra que renasce das ruínas do tradicional, mais poderosa, mais estranha, mais verdadeira.";
                }
                
                if (response && userCargo >= 3) { // Só responde se usuário tiver cargo 3+
                    addMessageToChat({
                        sender: "Assistente AR",
                        avatar: "AR",
                        cargo: 6,
                        time: "Agora",
                        text: response
                    }, false);
                }
            }, 1000);
        }

        // Enviar mensagem com Enter
        function sendMessageOnEnter(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
        }

        // Carregar lista de membros
        function loadMembers() {
            const membersList = document.getElementById('membersList');
            membersList.innerHTML = '';
            
            // Adicionar usuário atual à lista
            const allMembers = [...membros];
            if (currentUser) {
                allMembers.unshift({
                    ...currentUser,
                    atividade: userStatus === "online" ? "Online" : 
                              userStatus === "idle" ? "Ausente" :
                              userStatus === "dnd" ? "Não Perturbe" : "Offline"
                });
            }
            
            // Separar por status
            const onlineMembers = allMembers.filter(m => m.status === "online");
            const idleMembers = allMembers.filter(m => m.status === "idle");
            const dndMembers = allMembers.filter(m => m.status === "dnd");
            const offlineMembers = allMembers.filter(m => m.status === "offline");
            
            // Atualizar contador
            document.getElementById('onlineCount').textContent = onlineMembers.length + idleMembers.length;
            
            // Adicionar categorias
            if (onlineMembers.length > 0) {
                addMemberCategory("Online", onlineMembers);
            }
            
            if (idleMembers.length > 0) {
                addMemberCategory("Ausente", idleMembers);
            }
            
            if (dndMembers.length > 0) {
                addMemberCategory("Não Perturbe", dndMembers);
            }
            
            if (offlineMembers.length > 0) {
                addMemberCategory("Offline", offlineMembers);
            }
        }

        // Adicionar categoria de membros
        function addMemberCategory(title, members) {
            const membersList = document.getElementById('membersList');
            
            // Cabeçalho da categoria
            const categoryElement = document.createElement('div');
            categoryElement.className = 'members-category';
            categoryElement.textContent = `${title} — ${members.length}`;
            membersList.appendChild(categoryElement);
            
            // Membros
            members.forEach(member => {
                const cargoInfo = cargos[member.cargo-1] || cargos[0];
                
                const memberElement = document.createElement('div');
                memberElement.className = 'member';
                memberElement.innerHTML = `
                    <div class="member-avatar">
                        ${member.avatar}
                        <div class="member-status status-${member.status}"></div>
                    </div>
                    <div class="member-details">
                        <div class="member-name">${member.nome}</div>
                        <div class="member-activity">${member.atividade}</div>
                    </div>
                    <div class="member-cargo ${cargoInfo.cor}">${cargoInfo.nome}</div>
                `;
                
                memberElement.addEventListener('click', () => {
                    showMemberProfile(member);
                });
                
                membersList.appendChild(memberElement);
            });
        }

        // Filtrar membros
        function filterMembers(searchTerm) {
            const members = document.querySelectorAll('.member');
            const categories = document.querySelectorAll('.members-category');
            
            if (!searchTerm) {
                members.forEach(m => m.style.display = 'flex');
                categories.forEach(c => c.style.display = 'block');
                return;
            }
            
            const term = searchTerm.toLowerCase();
            let visibleCategories = new Set();
            
            members.forEach(member => {
                const name = member.querySelector('.member-name').textContent.toLowerCase();
                const cargo = member.querySelector('.member-cargo').textContent.toLowerCase();
                
                if (name.includes(term) || cargo.includes(term)) {
                    member.style.display = 'flex';
                    // Encontrar e mostrar categoria pai
                    let prev = member.previousElementSibling;
                    while (prev && !prev.classList.contains('members-category')) {
                        prev = prev.previousElementSibling;
                    }
                    if (prev) {
                        prev.style.display = 'block';
                        visibleCategories.add(prev);
                    }
                } else {
                    member.style.display = 'none';
                }
            });
            
            // Esconder categorias sem membros visíveis
            categories.forEach(category => {
                if (!visibleCategories.has(category)) {
                    category.style.display = 'none';
                }
            });
        }

        // Mostrar perfil do membro
        function showMemberProfile(member) {
            const cargoInfo = cargos[member.cargo-1] || cargos[0];
            
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.innerHTML = `
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-title">${member.nome}</div>
                        <div class="modal-subtitle">${cargoInfo.descricao}</div>
                    </div>
                    <div class="modal-body">
                        <div style="text-align: center; margin-bottom: 20px;">
                            <div class="user-avatar" style="width: 80px; height: 80px; margin: 0 auto 15px; font-size: 24px;">
                                ${member.avatar}
                                <div class="user-status status-${member.status}" style="width: 20px; height: 20px; border-width: 4px;"></div>
                            </div>
                            <div class="user-cargo ${cargoInfo.cor}" style="display: inline-block; padding: 8px 16px; font-size: 14px;">
                                ${cargoInfo.nome} (Cargo ${member.cargo})
                            </div>
                        </div>
                        <div style="margin-top: 20px;">
                            <h4 style="color: var(--text-secondary); margin-bottom: 10px;">Privilégios:</h4>
                            <ul style="color: var(--text-muted); padding-left: 20px;">
                                ${cargoInfo.privilegios.map(p => `<li>${p}</li>`).join('')}
                            </ul>
                        </div>
                        ${member.id === currentUser?.id ? '' : `
                        <div style="margin-top: 20px; display: flex; gap: 10px;">
                            <button class="btn btn-primary" style="flex: 1;" onclick="sendDirectMessage('${member.nome}')">Mensagem Direta</button>
                            <button class="btn btn-secondary" style="flex: 1;" onclick="addFriend('${member.nome}')">Adicionar Amigo</button>
                        </div>
                        `}
                    </div>
                    <div class="modal-footer">
                        <button class="btn btn-secondary" onclick="closeCurrentModal()">Fechar</button>
                    </div>
                </div>
                <button class="close-modal" onclick="closeCurrentModal()">×</button>
            `;
            
            document.body.appendChild(modal);
            
            // Adicionar função de fechar
            window.closeCurrentModal = function() {
                document.body.removeChild(modal);
            };
        }

        // Mostrar modal adicionar amigos
        function showAddFriendModal() {
            document.getElementById('addFriendModal').classList.remove('hidden');
        }

        // Enviar solicitação de amizade
        function sendFriendRequest() {
            const friendUsername = document.getElementById('friendUsernameInput').value.trim();
            const friendMessage = document.getElementById('friendMessage').value.trim();
            
            if (!friendUsername) {
                document.getElementById('friendUsernameError').style.display = 'block';
                return;
            }
            
            document.getElementById('friendUsernameError').style.display = 'none';
            
            // Verificar se é um membro existente
            const isMember = membros.some(m => m.nome.toLowerCase().includes(friendUsername.toLowerCase()));
            
            if (isMember) {
                addSystemMessage(`Solicitação de amizade enviada para ${friendUsername}. ${friendMessage ? `Mensagem: "${friendMessage}"` : ''}`);
            } else {
                addSystemMessage(`Usuário ${friendUsername} não encontrado na rede Algebra Renova.`);
            }
            
            closeModal('addFriendModal');
            document.getElementById('friendUsernameInput').value = '';
            document.getElementById('friendMessage').value = '';
        }

        // Adicionar amigo
        function addFriend(username) {
            closeCurrentModal();
            addSystemMessage(`${username} foi adicionado aos seus amigos!`);
        }

        // Enviar mensagem direta
        function sendDirectMessage(username) {
            closeCurrentModal();
            addSystemMessage(`Abrindo conversa direta com ${username}...`);
            // Em uma implementação real, isso abriria um chat privado
        }

        // Mostrar modal de configurações
        function showSettingsModal() {
            document.getElementById('settingsModal').classList.remove('hidden');
        }

        // Mudar tema
        function changeTheme() {
            const theme = document.getElementById('themeSelect').value;
            // Em uma implementação real, isso mudaria o tema
            addSystemMessage(`Tema alterado para: ${theme}`);
        }

        // Fechar modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }

        // Alternar visibilidade dos membros
        function toggleMembers() {
            membersVisible = !membersVisible;
            const membersSidebar = document.getElementById('membersSidebar');
            membersSidebar.style.display = membersVisible ? 'flex' : 'none';
        }

        // Alternar visibilidade dos canais (mobile)
        function toggleChannels() {
            const channelsSidebar = document.querySelector('.channels-sidebar');
            channelsSidebar.classList.toggle('active');
        }

        // Mostrar mensagens fixadas
        function showPinnedMessages() {
            addSystemMessage("Mensagens fixadas do canal serão mostradas aqui.");
        }

        // Alternar notificações
        function toggleNotifications() {
            addSystemMessage("Configurações de notificação abertas.");
        }

        // Reagir a mensagem
        function reactToMessage(element) {
            const message = element.closest('.message');
            // Em uma implementação real, isso adicionaria uma reação
            addSystemMessage("Reação adicionada à mensagem.");
        }

        // Responder a mensagem
        function replyToMessage(element) {
            const messageText = element.closest('.message').querySelector('.message-text').textContent;
            const messageInput = document.getElementById('messageInput');
            messageInput.value = `Replying to: "${messageText.substring(0, 50)}..." `;
            messageInput.focus();
        }

        // Mais ações
        function moreActions(element) {
            addSystemMessage("Menu de ações da mensagem aberto.");
        }

        // Mostrar menu de anexos
        function showAttachmentMenu() {
            if (userCargo < 3 && !cargos[userCargo-1].privilegios.includes('enviar_arquivos')) {
                addSystemMessage("Você precisa do cargo 3+ para enviar arquivos.");
                return;
            }
            addSystemMessage("Menu de anexos aberto. Você pode enviar arquivos matemáticos, imagens de diagramas, etc.");
        }

        // Mostrar seletor de emoji
        function showEmojiPicker() {
            addSystemMessage("Seletor de emoji aberto.");
        }

        // Upload de arquivo
        function uploadFile() {
            if (userCargo < 3 && !cargos[userCargo-1].privilegios.includes('enviar_arquivos')) {
                addSystemMessage("Você precisa do cargo 3+ para enviar arquivos.");
                return;
            }
            addSystemMessage("Seletor de arquivos aberto. Formatos permitidos: .pdf, .tex, .png, .jpg");
        }

        // Mudar servidor
        function changeServer(serverName) {
            addSystemMessage(`Mudando para servidor: ${serverName}. Em desenvolvimento.`);
        }

        // Obter iniciais do nome
        function getInitials(name) {
            return name.split(' ')
                .map(word => word.charAt(0))
                .join('')
                .toUpperCase()
                .substring(0, 2);
        }

        // Mostrar registro
        function showRegister() {
            addSystemMessage("Funcionalidade de registro em desenvolvimento. Para testar, use qualquer nome de usuário e senha.");
        }

        // Para demonstração: login automático após 3 segundos
        setTimeout(() => {
            // Auto-login para demonstração
            // document.getElementById('username').value = 'NovoUsuario';
            // document.getElementById('password').value = 'teste123';
            // login();
        }, 3000);
    </script>
</body>
</html>
